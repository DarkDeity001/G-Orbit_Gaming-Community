{"ast":null,"code":"import _asyncToGenerator from \"D:/Gamer`s Orbit/clips/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { delay, map } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/fire/compat/auth\";\nimport * as i2 from \"@angular/fire/compat/firestore\";\nexport class AuthService {\n  constructor(auth, db) {\n    this.auth = auth;\n    this.db = db;\n    this.usersCollection = db.collection('users');\n    this.isAuthenticated$ = auth.user.pipe(map(user => !!user));\n    this.isAuthenticatedWithDelay$ = this.isAuthenticated$.pipe(delay(1000));\n  }\n  createUser(userData) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      if (!userData.password) {\n        throw new Error(\"Password not provided!\");\n      }\n      const userCred = yield _this.auth.createUserWithEmailAndPassword(userData.email, userData.password);\n      if (!userCred.user) {\n        throw new Error(\"User can't be found\");\n      }\n      yield _this.usersCollection.doc(userCred.user.uid).set({\n        name: userData.name,\n        email: userData.email,\n        age: userData.age,\n        phoneNumber: userData.phoneNumber\n      });\n      yield userCred.user.updateProfile({\n        displayName: userData.name\n      });\n    })();\n  }\n}\nAuthService.ɵfac = function AuthService_Factory(t) {\n  return new (t || AuthService)(i0.ɵɵinject(i1.AngularFireAuth), i0.ɵɵinject(i2.AngularFirestore));\n};\nAuthService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: AuthService,\n  factory: AuthService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"names":["delay","map","AuthService","constructor","auth","db","usersCollection","collection","isAuthenticated$","user","pipe","isAuthenticatedWithDelay$","createUser","userData","_this","_asyncToGenerator","password","Error","userCred","createUserWithEmailAndPassword","email","doc","uid","set","name","age","phoneNumber","updateProfile","displayName","i0","ɵɵinject","i1","AngularFireAuth","i2","AngularFirestore","factory","ɵfac","providedIn"],"sources":["D:\\Gamer`s Orbit\\clips\\src\\app\\services\\auth.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { AngularFireAuth } from '@angular/fire/compat/auth';\nimport { AngularFirestore, AngularFirestoreCollection } from '@angular/fire/compat/firestore';\nimport { Observable } from 'rxjs';\nimport IUser from '../models/user.model';\nimport { delay, map } from 'rxjs/operators'\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AuthService {\n  private usersCollection: AngularFirestoreCollection<IUser>\n  public isAuthenticated$: Observable<boolean>\n  public isAuthenticatedWithDelay$: Observable<boolean>\n\n  constructor(\n    private auth: AngularFireAuth,\n    private db: AngularFirestore\n  ) { \n    this.usersCollection = db.collection('users')\n    this.isAuthenticated$ = auth.user.pipe(\n      map(user => !!user)\n    )\n    this.isAuthenticatedWithDelay$ = this.isAuthenticated$.pipe(\n      delay(1000)\n    )\n  }\n  \n  public async createUser(userData: IUser) {\n    if(!userData.password) {\n      throw new Error(\"Password not provided!\")\n    }\n\n    const userCred = await this.auth.createUserWithEmailAndPassword(\n      userData.email, userData.password\n    )\n\n    if(!userCred.user) {\n      throw new Error(\"User can't be found\")\n    }\n    \n    await this.usersCollection.doc(userCred.user.uid).set({\n      name: userData.name,\n      email: userData.email,\n      age: userData.age,\n      phoneNumber: userData.phoneNumber\n    })\n\n    await userCred.user.updateProfile({\n      displayName: userData.name\n    })\n  }\n}\n"],"mappings":";AAKA,SAASA,KAAK,EAAEC,GAAG,QAAQ,gBAAgB;;;;AAK3C,OAAM,MAAOC,WAAW;EAKtBC,YACUC,IAAqB,EACrBC,EAAoB;IADpB,KAAAD,IAAI,GAAJA,IAAI;IACJ,KAAAC,EAAE,GAAFA,EAAE;IAEV,IAAI,CAACC,eAAe,GAAGD,EAAE,CAACE,UAAU,CAAC,OAAO,CAAC;IAC7C,IAAI,CAACC,gBAAgB,GAAGJ,IAAI,CAACK,IAAI,CAACC,IAAI,CACpCT,GAAG,CAACQ,IAAI,IAAI,CAAC,CAACA,IAAI,CAAC,CACpB;IACD,IAAI,CAACE,yBAAyB,GAAG,IAAI,CAACH,gBAAgB,CAACE,IAAI,CACzDV,KAAK,CAAC,IAAI,CAAC,CACZ;EACH;EAEaY,UAAUA,CAACC,QAAe;IAAA,IAAAC,KAAA;IAAA,OAAAC,iBAAA;MACrC,IAAG,CAACF,QAAQ,CAACG,QAAQ,EAAE;QACrB,MAAM,IAAIC,KAAK,CAAC,wBAAwB,CAAC;;MAG3C,MAAMC,QAAQ,SAASJ,KAAI,CAACV,IAAI,CAACe,8BAA8B,CAC7DN,QAAQ,CAACO,KAAK,EAAEP,QAAQ,CAACG,QAAQ,CAClC;MAED,IAAG,CAACE,QAAQ,CAACT,IAAI,EAAE;QACjB,MAAM,IAAIQ,KAAK,CAAC,qBAAqB,CAAC;;MAGxC,MAAMH,KAAI,CAACR,eAAe,CAACe,GAAG,CAACH,QAAQ,CAACT,IAAI,CAACa,GAAG,CAAC,CAACC,GAAG,CAAC;QACpDC,IAAI,EAAEX,QAAQ,CAACW,IAAI;QACnBJ,KAAK,EAAEP,QAAQ,CAACO,KAAK;QACrBK,GAAG,EAAEZ,QAAQ,CAACY,GAAG;QACjBC,WAAW,EAAEb,QAAQ,CAACa;OACvB,CAAC;MAEF,MAAMR,QAAQ,CAACT,IAAI,CAACkB,aAAa,CAAC;QAChCC,WAAW,EAAEf,QAAQ,CAACW;OACvB,CAAC;IAAA;EACJ;;;mBAzCWtB,WAAW,EAAA2B,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,eAAA,GAAAH,EAAA,CAAAC,QAAA,CAAAG,EAAA,CAAAC,gBAAA;AAAA;;SAAXhC,WAAW;EAAAiC,OAAA,EAAXjC,WAAW,CAAAkC,IAAA;EAAAC,UAAA,EAFV;AAAM"},"metadata":{},"sourceType":"module"}