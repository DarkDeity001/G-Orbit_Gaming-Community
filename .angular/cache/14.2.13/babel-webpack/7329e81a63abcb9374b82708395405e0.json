{"ast":null,"code":"import _asyncToGenerator from \"D:/Gamer`s Orbit/clips/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { of } from 'rxjs';\nimport { delay, map, filter, switchMap } from 'rxjs/operators';\nimport { NavigationEnd } from '@angular/router';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/fire/compat/auth\";\nimport * as i2 from \"@angular/fire/compat/firestore\";\nimport * as i3 from \"@angular/router\";\nexport let AuthService = /*#__PURE__*/(() => {\n  class AuthService {\n    constructor(auth, db, router, route) {\n      this.auth = auth;\n      this.db = db;\n      this.router = router;\n      this.route = route;\n      this.redirect = false;\n      this.usersCollection = db.collection('users');\n      this.isAuthenticated$ = auth.user.pipe(map(user => !!user));\n      this.isAuthenticatedWithDelay$ = this.isAuthenticated$.pipe(delay(1000));\n      this.router.events.pipe(filter(e => e instanceof NavigationEnd), map(e => this.route.firstChild), switchMap(route => {\n        var _a;\n\n        return (_a = route === null || route === void 0 ? void 0 : route.data) !== null && _a !== void 0 ? _a : of({});\n      })).subscribe(data => {\n        var _a;\n\n        this.redirect = (_a = data.authOnly) !== null && _a !== void 0 ? _a : false;\n      });\n    }\n\n    createUser(userData) {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        if (!userData.password) {\n          throw new Error(\"Password not provided!\");\n        }\n\n        const userCred = yield _this.auth.createUserWithEmailAndPassword(userData.email, userData.password);\n\n        if (!userCred.user) {\n          throw new Error(\"User can't be found\");\n        }\n\n        yield _this.usersCollection.doc(userCred.user.uid).set({\n          name: userData.name,\n          email: userData.email,\n          age: userData.age,\n          phoneNumber: userData.phoneNumber\n        });\n        yield userCred.user.updateProfile({\n          displayName: userData.name\n        });\n      })();\n    }\n\n    logout($event) {\n      var _this2 = this;\n\n      return _asyncToGenerator(function* () {\n        if ($event) {\n          $event.preventDefault();\n        }\n\n        yield _this2.auth.signOut();\n\n        if (_this2.redirect) {\n          yield _this2.router.navigateByUrl('/');\n        }\n      })();\n    }\n\n  }\n\n  AuthService.ɵfac = function AuthService_Factory(t) {\n    return new (t || AuthService)(i0.ɵɵinject(i1.AngularFireAuth), i0.ɵɵinject(i2.AngularFirestore), i0.ɵɵinject(i3.Router), i0.ɵɵinject(i3.ActivatedRoute));\n  };\n\n  AuthService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: AuthService,\n    factory: AuthService.ɵfac,\n    providedIn: 'root'\n  });\n  return AuthService;\n})();","map":null,"metadata":{},"sourceType":"module"}